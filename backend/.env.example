# ===============================================
# LIVRIA Backend - Environment Variables Example
# ===============================================
# Copy this file to .env and fill in your values
# Never commit .env to version control!
# ===============================================

# ======================
# Core Application
# ======================
NODE_ENV=development
PORT=3000

# ======================
# Database (PostgreSQL)
# ======================
# Required: Your PostgreSQL connection string
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=public
DATABASE_URL="postgresql://postgres:password@localhost:5432/livria?schema=public"

# DIRECT_URL - Conexão direta (obrigatória para Prisma Migrate com Supabase)
# Para Supabase: use porta 5432 (direta), SEM ?pgbouncer=true
# A DATABASE_URL (pooled, porta 6543) NÃO funciona para migrations
DIRECT_URL="postgresql://postgres:password@localhost:5432/livria?schema=public"

# ======================
# Redis (Optional)
# ======================
# Set to 'false' to disable Redis-based queues and use in-memory fallback
REDIS_ENABLED=true

# Option 1: Use REDIS_URL (Recommended for Redis.io, Upstash, etc.)
# Format: redis://user:password@host:port or rediss://user:password@host:port (with TLS)
REDIS_URL=

# Option 2: Use individual settings (Fallback)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# ======================
# JWT Authentication
# ======================
# IMPORTANT: Generate secure random strings for production!
# Use: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_REFRESH_SECRET=your-refresh-secret-key-change-in-production

# Session Duration Configuration
# JWT_EXPIRES_IN: Access token expiration (default: 2d - 2 days)
#   Supported formats: 1h, 2d, 7d, etc.
#   This controls how long a user stays logged in
JWT_EXPIRES_IN=2d

# JWT_REFRESH_EXPIRES_IN: Refresh token expiration (default: 30d - 30 days)
#   Supported formats: 7d, 30d, 90d, etc.
#   After this period, user must login again
#   Should be longer than JWT_EXPIRES_IN
JWT_REFRESH_EXPIRES_IN=30d

# ======================
# CORS Configuration
# ======================
# Comma-separated list of allowed origins for production
# Example: https://livria.com,https://www.livria.com
ALLOWED_ORIGINS=http://localhost:4200,http://localhost:3000

# ======================
# Push Notifications (Web Push / VAPID)
# ======================
# Generate VAPID keys: npx web-push generate-vapid-keys
VAPID_PUBLIC_KEY=
VAPID_PRIVATE_KEY=
VAPID_SUBJECT=mailto:support@livria.com

# ======================
# Stripe (Payments & Subscriptions)
# ======================
# Get keys from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

# Stripe Price IDs (create in Stripe Dashboard)
STRIPE_PREMIUM_MONTHLY_PRICE_ID=price_premium_monthly
STRIPE_PREMIUM_YEARLY_PRICE_ID=price_premium_yearly
STRIPE_PRO_MONTHLY_PRICE_ID=price_pro_monthly
STRIPE_PRO_YEARLY_PRICE_ID=price_pro_yearly

# ======================
# AI Providers
# ======================
# AI Service gateway (single TTS execution path via proxy)
# Backend public routes (/api/voices, /api/voices/preview, /api/speeches/:id/audio)
# forward TTS calls to this service.
AI_SERVICE_URL=http://localhost:3001/api
AI_SERVICE_API_KEY=

# Default providers for each capability
AI_TEXT_PROVIDER=gemini
AI_IMAGE_PROVIDER=gemini
AI_TTS_PROVIDER=gemini

# --- Google Gemini (Recommended) ---
# Get key from: https://aistudio.google.com/apikey
GEMINI_API_KEY=sua_chave_api_aqui
GEMINI_TEXT_MODEL=gemini-2.0-flash
GEMINI_IMAGE_MODEL=imagen-3.0-generate-001
GEMINI_TTS_MODEL=gemini-2.5-flash-preview-tts

# Rate limiting for Gemini
GEMINI_RATE_LIMIT_RPM=15
GEMINI_RATE_LIMIT_RETRY_DELAY=5000
GEMINI_RATE_LIMIT_MAX_RETRIES=5

# --- OpenAI (Optional Alternative) ---
# Get key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=
OPENAI_TEXT_MODEL=gpt-4o
OPENAI_IMAGE_MODEL=dall-e-3
OPENAI_TTS_MODEL=tts-1-hd
OPENAI_RATE_LIMIT_RPM=60
OPENAI_RATE_LIMIT_RETRY_DELAY=1000
OPENAI_RATE_LIMIT_MAX_RETRIES=3

# --- Anthropic Claude (Optional Alternative) ---
# Get key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=
ANTHROPIC_TEXT_MODEL=claude-3-5-sonnet-20241022
ANTHROPIC_RATE_LIMIT_RPM=60
ANTHROPIC_RATE_LIMIT_RETRY_DELAY=1000
ANTHROPIC_RATE_LIMIT_MAX_RETRIES=3

# --- Stability AI (Optional - Image Generation) ---
# Get key from: https://platform.stability.ai/
STABILITY_API_KEY=
STABILITY_IMAGE_MODEL=stable-diffusion-xl-1024-v1-0

# --- ElevenLabs (Optional - TTS) ---
# Get key from: https://elevenlabs.io/
# To use ElevenLabs as TTS provider, set AI_TTS_PROVIDER=elevenlabs
ELEVENLABS_API_KEY=
ELEVENLABS_DEFAULT_VOICE=Rachel
ELEVENLABS_MODEL=eleven_multilingual_v2
# Voice settings (0.0 to 1.0)
ELEVENLABS_VOICE_STABILITY=0.5
ELEVENLABS_VOICE_SIMILARITY=0.75
ELEVENLABS_VOICE_STYLE=0.0
ELEVENLABS_SPEAKER_BOOST=true
# Rate limiting for ElevenLabs
ELEVENLABS_RATE_LIMIT_RPM=10
ELEVENLABS_RATE_LIMIT_RETRY_DELAY=2000
ELEVENLABS_RATE_LIMIT_MAX_RETRIES=3

# --- Azure Speech (Optional - TTS) ---
# Get key from: https://azure.microsoft.com/services/cognitive-services/speech-services/
AZURE_SPEECH_KEY=
AZURE_SPEECH_REGION=eastus

# ======================
# Google Cloud (Audio & Drive Storage)
# ======================
# Path to your Google Cloud service account JSON key file
# Required for audio storage and Google Drive integration
GOOGLE_APPLICATION_CREDENTIALS=./path/to/service-account.json
DRIVE_ROOT_FOLDER_ID=

# ======================
# Feature Flags (Optional)
# ======================
# Enable/disable specific features
ENABLE_PUSH_NOTIFICATIONS=true
ENABLE_STRIPE_PAYMENTS=true
ENABLE_AI_FEATURES=true
