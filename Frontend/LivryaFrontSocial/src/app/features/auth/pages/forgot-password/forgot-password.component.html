<ng-container *transloco="let t">
  <div class="forgot-container">
    <div class="forgot-card">
      <div class="language-selector-wrapper">
        <app-language-selector />
      </div>

      <div class="forgot-logo">
        <span class="logo-icon"><img src="assets/logosm.png" width="40px" alt="logo livrya"></span>
        <img src="assets/logo.png" width="100px" alt="logo livrya">
      </div>
      @if (!emailSent()) {
        <div class="forgot-header">
          <div class="icon-wrapper">
            <i class="pi pi-lock"></i>
          </div>
          <h1>{{ t('auth.forgotPassword.title') }}</h1>
          <p>{{ t('auth.forgotPassword.subtitle') }}</p>
        </div>

        @if (errorMessage) {
          <p-message severity="error" [text]="errorMessage" styleClass="w-full mb-4" />
        }

        <form [formGroup]="forgotForm" (ngSubmit)="onSubmit()" class="forgot-form">
          <div class="field">
            <label for="email">{{ t('auth.forgotPassword.email') }}</label>
            <input
              pInputText
              id="email"
              type="email"
              formControlName="email"
              [placeholder]="t('auth.forgotPassword.emailPlaceholder')"
              class="w-full"
            />
            @if (f['email'].invalid && f['email'].touched) {
              <small class="p-error">
                @if (f['email'].errors?.['required']) {
                  {{ t('validation.required', { field: t('auth.forgotPassword.email') }) }}
                } @else if (f['email'].errors?.['email']) {
                  {{ t('validation.email') }}
                }
              </small>
            }
          </div>

          <p-button
            type="submit"
            [label]="t('auth.forgotPassword.submit')"
            styleClass="w-full"
            [loading]="isSubmitting()"
            [disabled]="forgotForm.invalid || isSubmitting()"
          />
        </form>
      } @else {
        <div class="success-state">
          <div class="icon-wrapper success">
            <i class="pi pi-check"></i>
          </div>
          <h1>{{ t('auth.forgotPassword.successTitle') }}</h1>
          <p>{{ successMessage }}</p>
          <p class="hint">{{ t('auth.forgotPassword.checkInbox') }}</p>

          <p-button
            [label]="t('auth.forgotPassword.resend')"
            [outlined]="true"
            styleClass="w-full mt-4"
            (onClick)="resendEmail()"
          />
        </div>
      }

      <div class="forgot-footer">
        <a routerLink="/auth/login">
          <i class="pi pi-arrow-left"></i>
          {{ t('auth.forgotPassword.backToLogin') }}
        </a>
      </div>
    </div>
  </div>
</ng-container>
